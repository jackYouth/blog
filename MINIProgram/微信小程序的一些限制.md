# 微信小程序的一些限制

### 订阅消息

```js
wx.requestSubscribeMessage({
  tmplIds: [""],
  success(res) {},
})
```

- 一次性模板 id 和永久模板 id 不可同时使用。
- 低版本基础库 2.4.4~2.8.3 已支持订阅消息接口调用，仅支持传入一个一次性 tmplId / 永久 tmplId。
- 2.8.2 版本开始，用户**发生点击行为或者发起支付回调**后，才可以调起订阅消息界面。
- 2.10.0 版本开始，开发版和体验版小程序将禁止使用模板消息 formId。

不再询问的复选框：

- 勾选之后，相同的模版就不会在提示出来了，只能通过小程序设置里的订阅消息去管理
  > 如果此次订阅的模版都勾过不再询问的话，订阅弹窗则不弹出

### webview

- 左上角按钮样式
  - 如果路由进入 webview 页面，不是小程序的一级路由，则会出现返回箭头
  - 如果是扫码进入，且 webview 属于一级路由，则出现【返回首页】
  - 如果扫码进入，webview 属于第二个路由，则出现返回箭头

### 小程序向公众号用户推送消息

公众号拉起小程序，透传保存到用户中心，然后小程序里想发消息的时候，就根据当前 userId 找到保存的公众号 openId，调他们接口（或其他方式），传入 openId 和消息体，即可发消息。碧文之前做过的药店云有过类似的操作。

### 微信分享

- app 分享至微信时，图片过大且为 jpg 时会变糊。 解决方案：改为 png，png 格式微信不会压缩太狠。

### 小程序向公众号用户推消息

公众号进入小程序时，将公众号下该用户的 openid 和用户 id 进行绑定，当需要推消息时，服务端根据用户 id 找到 openid 给该用户推消息

### 微信环境中的一些链接中，因为可能出现分享、浏览器打开这种，所以 url 中不能出现敏感参数，比如 userId、mobile 这些
